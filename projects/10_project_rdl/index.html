<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> A POMDP Approach for Safety Assessment of Autonomous Cars | Robust Decision Making Lab </title> <meta name="author" content="You R. Name"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/rdl_logo.png?11e5b2abd7dfd8659b915ab84202c2be"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://rdllab.github.io/projects/10_project_rdl/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <img src="/assets/img/rdl_logo.png?11e5b2abd7dfd8659b915ab84202c2be" class="img-fluid" style="height: 60px;" alt=""> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">home </a> </li> <li class="nav-item "> <a class="nav-link" href="/project/">project </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">news </a> </li> <li class="nav-item "> <a class="nav-link" href="/contact/">contact </a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">A pomdp approach for safety assessment of autonomous cars</h1> </header> <article> <h2>Abstract</h2> <p class="text-justify"> This paper proposes a mechanism to automatically assess the safety of autonomous robots, and in particular autonomous cars. Most methods to assess the safety of autonomous cars generate adver-sary strategies, which will then be used to test whether the car beingassessed can avoid accidents with the adversary. To generate such adversarial strategies, many have proposed learning techniques that requirea large amount of accident data. But, such data are difficult to obtain because accidents are rare. To alleviate this issue, we leverage the observation that when safe and colliding adversary trajectories are closer together, the vehicle is less safe because there is generally less buffer to avoid accidents. Specifically, we generate/utilise data on adversaries’ safe trajectories, which is more abundant than accidents data, and compute colliding adversarial trajectories that are as close as possible to the safe trajectories. The average distance between safe and colliding adversarial trajectories provides an indicator of the vehicles’ safety. To compute colliding adversarial trajectories, we take into account that the driving strategy of the vehicle being assessed is not fully known, and therefore propose a multi-objecive POMDP framing of the problem and an on-line planning method, called Constraint-Aware Tree (CAT), to compute approximate solution to the multi-objective POMDP. Evaluations of four learning-based autonomous driving software on pedestrian crossing and lane merging scenarios, derived from the National Highway Traffic Safety Administration (NHTSA), indicate the viability of the proposed testing mechanism in assessing a variety of autonomy software. Moreover, evaluations of CAT on the nuScenes dataset indicate that CAT generates more colliding adversarial trajectories in less time compared to state-of-the-artlearning-based method, STRIVE. </p> <h2>Proposed Safety Assessment Mechanism</h2> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/project_img/safety/framework-480.webp 480w,/assets/img/project_img/safety/framework-800.webp 800w,/assets/img/project_img/safety/framework-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/project_img/safety/framework.png" class="img-fluid rounded z-depth-0" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>The framework relies on the observation that in autonomous vehicles, the smaller the distance between adversaries’ safe trajectories and their closest colliding trajectories, the less safe the autonomous car being assessed is, because there is less margin for errors. An overview of the framework are as follows:</p> <ol> <li>It takes the vehicles kinematics and dynamic constraints as inputs, together with the adversary safe trajectories.</li> <li>It then uses our proposed online POMDP solver, CAT to compute a set of corresponding adversary collision trajectories.</li> <li>The safety rating is then computed as the average Fréchet distance between the adversary safe trajectories and the generated collision trajectories.</li> </ol> <h2>Constraint-Aware Tree (CAT)</h2> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/project_img/safety/cat-algo-480.webp 480w,/assets/img/project_img/safety/cat-algo-800.webp 800w,/assets/img/project_img/safety/cat-algo-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/project_img/safety/cat-algo.png" class="img-fluid rounded z-depth-0" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Our proposed framework requires computation of collision trajectories with conflicting nature of objectives. In our mechanism, we want the adversaries to collide with the vehicle being assessed as fast as possible, while being as close as possible to a given safe trajectory. Hence, we propose CAT, A novel online POMDP solver that computes a close to optimal policy to solve this multi-objective problem. CAT adopts the epsilon-constraint approach to transform this multi-objective POMDP into multiple constrained POMDPs, where the difference between them are only in the values of the constraints. Here, the distance to the safe trajectory is set as a constraint.</p> <p>Given CPOMDP problems \(P_{\phi,\epsilon_{i}}=\left\langle S,A,T,O,Z,R,\gamma,C,\phi,\epsilon_{i} \right\rangle\). To solve these multiple constraint POMDP problems, CAT first selects a set of upper bound values \(\left\{ \epsilon_{1},\epsilon_{2} \cdots,\epsilon_{n} \right\}\) for the distance constraint, and constructs CPOMDP problems for each \(\epsilon_{i}\) for \(i \in \left[ 1,n \right]\). We frame each constraint POMDP in such a way that we can solve them as POMDPs, where states that does not satisfy the constraints (\(d\left( \phi,s \right)\gt \epsilon_{i}\)) becomes terminating states, and entering them incurs a penalty.</p> <figure> <video src="/assets/img/project_img/safety/merge1.mp4" class="img-fluid rounded z-depth-0" width="auto" height="auto" autoplay="" loop="" muted=""></video> </figure> <p>Although these simplified POMDP problems can be solved using existing solvers, solving n POMDP problems separately for each safe trajectory can be very expensive. Since each problem \(\epsilon_{i}\) for \(i \in \left[ 1,n \right]\) only differs only in their reward function, and having a substructure property where the set of reachable beliefs of POMDPs associated with smaller distance constraints is a subset of POMDPs associated with larger distance constraints, CAT exploits these 2 features to reuse prior computations and compute solutions to all $n$ POMDP problems at once. To achieve this, CAT maintains value functions \(\left[ V_{1}(b),V_{2}(b) \cdots,V_{n}(b) \right]\) for each \(P_{\phi,\epsilon_{i}}\), and during online planning, decide which POMDP problem to evaluate using PUCT strategy. Due to the aforementioned features, the outcome of sampling for one POMDP can be propagated to other POMDP problems, thus increasing sampling efficiency and accuracy.</p> <h2>Experiment: Evaluation of CAT on nuScenes Dataset</h2> <p>The first experiment here is to verify CAT as a suitable method for adversarial trajectory generation. We conduct this set of experiments on the nuScenes dataset, which consists of complex vehicle-vehicle traffic scenarios. In each of these scenarios, we control an adversarial vehicle to generate a trajectory to collide with the identified target vehicle, while avoiding other traffic participants.</p> <div class="row"> <div class="col-sm-9 mt-3 mt-md-0 mx-auto"> <figure> <video src="/assets/img/project_img/safety/nuscne.mp4" class="img-fluid rounded z-depth-0" width="800px" height="auto" controls="" muted=""></video> </figure> </div> </div> <h3>Quantitative Results</h3> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/project_img/safety/table1-480.webp 480w,/assets/project_img/safety/table1-800.webp 800w,/assets/project_img/safety/table1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/project_img/safety/table1.jpg" class="img-fluid rounded z-depth-0" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h3>Qualitative Results</h3> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/project_img/safety/comp-480.webp 480w,/assets/project_img/safety/comp-800.webp 800w,/assets/project_img/safety/comp-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/project_img/safety/comp.jpg" class="img-fluid rounded z-depth-0" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>We observe that in some scenarios, STRIVE generates invalid collision trajectories by moving out of road boundaries, likely due to inaccuracies in its trained traffic model. The POMDP methods, CAT and ABT, are able to avoid this by encoding environmental collisions within the POMDP formulation, and can generate valid collision trajectories in these scenes.</p> <h2>Experiment: Evaluation of Assessment Mechanism</h2> <h3>Experimental Setup</h3> <p>This second set of experiments is to evaluate if our proposed safety assessment mechanism, using Fréchet distance as a metric, can be used to accurately assign vehicle safety ranking to different car controllers. We implement 2 different experiment scenarios based on the NHTSA (National Highway Traffic Safety Administration) pre-crash scenario typology, namely pedestrian crossing and vehicle lane merging, to test our proposed safety assessment mechanism. We evaluate 4 of the top ranked vehicle controllers from the CARLA Leaderboard, each under 2 weather conditions, dry and wet.</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/project_img/safety/ranking-480.webp 480w,/assets/img/project_img/safety/ranking-800.webp 800w,/assets/img/project_img/safety/ranking-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/project_img/safety/ranking.jpg" class="img-fluid rounded z-depth-0" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h3>Scenario 1: Pedestrian Crossing (Collision Trajectory Generation)</h3> <div class="row"> <div class="col-sm-9 mt-3 mt-md-0 mx-auto"> <figure> <video src="/assets/img/project_img/safety/cw.mp4" class="img-fluid rounded z-depth-0" width="800px" height="auto" controls="" muted=""></video> </figure> </div> </div> <h3>Scenario 1: Experimental Results</h3> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/project_img/safety/carla1-480.webp 480w,/assets/img/project_img/safety/carla1-800.webp 800w,/assets/img/project_img/safety/carla1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/project_img/safety/carla1.jpg" class="img-fluid rounded z-depth-0" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h3>Scenario 2: Vehicle Lane Merging (Collision Trajectory Generation)</h3> <div class="row"> <div class="col-sm-9 mt-3 mt-md-0 mx-auto"> <figure> <video src="/assets/img/project_img/safety/ml.mp4" class="img-fluid rounded z-depth-0" width="800px" height="auto" controls="" muted=""></video> </figure> </div> </div> <h3>Scenario 2: Experimental Results</h3> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/project_img/safety/carla2-480.webp 480w,/assets/img/project_img/safety/carla2-800.webp 800w,/assets/img/project_img/safety/carla2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/project_img/safety/carla2.jpg" class="img-fluid rounded z-depth-0" width="100%" height="auto" title="example image" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>We observe that the safer the controller is (given by the lower collision rate from validating random trajectories), the higher the Fréchet Distance obtained from generating the collision trajectories using CAT, indicating the vehicle has larger room to account for errors and uncertainty. In this scenario, compared to Carla Leaderboard, the vehicle rankings are the same for collision involving other vehicles. The results indicate that it is important to account for the behavior and inner workings of the assessed vehicle as partially observed variables.</p> <h2> References </h2> <div class="publications"> <h2 class="bibliography">2024</h2> <ol class="bibliography"><li> <div class="row"> <div class="col col-sm-2 abbr"> </div> <div id="Ang24:Apomdp" class="col-sm-8"> <div class="title">A POMDP Approach for Safety Assessment of Autonomous Cars (Accepted)</div> <div class="author"> I. Ang and H. Kurniawati </div> <div class="periodical"> <em>In International Workshop on the Algorithmic Foundations of Robotics</em>, 2024 </div> <div class="periodical"> </div> <div class="links"> <a class="bibtex btn btn-sm z-depth-0" role="button">Bib</a> <a href="/assets/pdf/papers/wafr2024_apomdp.pdf" class="btn btn-sm z-depth-0" role="button">PDF</a> </div> <div class="bibtex hidden"> <figure class="highlight"><pre><code class="language-bibtex" data-lang="bibtex"><span class="nc">@inproceedings</span><span class="p">{</span><span class="nl">Ang24:Apomdp</span><span class="p">,</span>
  <span class="na">title</span> <span class="p">=</span> <span class="s">{A POMDP Approach for Safety Assessment of Autonomous Cars (Accepted)}</span><span class="p">,</span>
  <span class="na">author</span> <span class="p">=</span> <span class="s">{Ang, I. and Kurniawati, H.}</span><span class="p">,</span>
  <span class="na">booktitle</span> <span class="p">=</span> <span class="s">{International Workshop on the Algorithmic Foundations of Robotics}</span><span class="p">,</span>
  <span class="na">year</span> <span class="p">=</span> <span class="s">{2024}</span><span class="p">,</span>
  <span class="na">publisher</span> <span class="p">=</span> <span class="s">{Springer}</span><span class="p">,</span>
<span class="p">}</span></code></pre></figure> </div> </div> </div> </li></ol> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Robust Decision Making Lab. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css"> </html>